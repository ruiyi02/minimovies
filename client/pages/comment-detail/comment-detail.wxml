<view class="page"> 
  <view class="page__bd">  
      <navigator url="../movie-detail/movie-detail?id={{movie.id}}">
        <view  class="movie-image">
          <image src="{{movie.image}}" mode="aspectFit" style="width: 600rpx" />  
        </view>       
        <view class='movie-title'>{{movie.title}}</view>                           
      </navigator>           
      <view class="comment-card content-above-btn">
          <image class='comment-avatar' src='{{comment.avatar}}'></image>
          <view class='comment-cnt'>
            <view class='comment-top'>
              <view class='comment-username'>{{comment.username}}</view>
              <view class="comment-time">{{comment.fromNow}}</view>
            </view>          
            <view wx:if="{{comment.content}}" class='comment-content'>{{comment.content}}</view> 
            <view class='play-btn' wx:else>
              <record url='{{preview? comment.voiceTempFilePath : comment.voice}}' ></record>
            </view> 
          </view> 
      </view>
   
        <view wx:if="{{preview}}">
          <view class="weui-flex btn-bottom">
            <view class="weui-flex__item">
              <button type="primary" plain="true"  style='width:98%' bindtap='editComment'>编辑</button>
            </view>
            <view class="weui-flex__item">
                <button type="primary" plain="true"  style='width:98%' bindtap='uploadComment'>发布</button> 
            </view>                 
          </view>   
        </view>             
        <view wx:else>
          <view class="weui-flex btn-bottom">
            <view class="weui-flex__item">
              <button wx:if="{{comment.is_favorite}}" type="primary" plain="true" style='width:98%' bindtap='loginAndDeleteFavorite'>删除收藏</button>
              <button wx:else type="primary" plain="true" style='width:98%' bindtap='loginAndAddFavorite'>加入收藏</button>
            </view>
            <view class="weui-flex__item">
            <button wx:if="{{!comment_published}}" type="primary" plain="true" style="width:98%" bindtap='loginAndAddComment'>添加影评</button> 
              <button wx:elif="{{!comment.is_published}}" type="primary" plain="true" style="width:98%" bindtap='loginAndViewComment'>我的影评</button>               
            </view>                 
          </view>      

      </view>              
   </view>
</view>

